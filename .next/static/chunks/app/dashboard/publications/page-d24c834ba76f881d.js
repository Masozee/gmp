(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[197],{3132:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Z});var s=a(95155),r=a(12115),l=a(34301),n=a(75074),i=a(9572),c=a(14733),o=a(30285),d=a(62523),u=a(59409),h=a(66695),m=a(35695),x=a(37648),p=a(58127),f=a(65064),j=a(67554),g=a(1199),b=a(24910),y=a(68718),N=a(3561),v=a(17607),w=a(75943),C=a(77223),S=a(56671),A=a(85127),R=a(44838),k=a(26126),E=a(91394),T=a(47262),D=a(90010),z=a(62177),P=a(90221),F=a(55594),I=a(21887),L=a(10518),B=a(18046),O=a(54165),U=a(17759),V=a(88539),H=a(17972),_=a(14636),q=a(59434);let $=F.Ik({title:F.Yj().min(3,"Title must be at least 3 characters").max(100,"Title must be less than 100 characters"),description:F.Yj().min(10,"Description must be at least 10 characters").max(500,"Description must be less than 500 characters"),content:F.Yj().min(50,"Content must be at least 50 characters"),status:F.k5(["DRAFT","PUBLISHED"],{required_error:"Please select a status"}),category:F.Yj().min(1,"Category is required"),tags:F.YO(F.Yj()).optional(),coverCredit:F.Yj().optional(),coverImage:F.bz().refine(e=>!e||e instanceof File&&e.size<=5242880,"Cover image must be less than 5MB").optional(),authors:F.YO(F.Yj()).min(1,"At least one author is required")});function M(e){let{open:t,onOpenChange:a,onSuccess:l}=e,n=(0,m.useRouter)(),[i,c]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),[p,f]=(0,r.useState)([]),[j,g]=(0,r.useState)([]),[b,y]=(0,r.useState)([]),[N,v]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),A=(0,z.mN)({resolver:(0,P.u)($),defaultValues:{title:"",description:"",content:"",status:"DRAFT",category:"",tags:[],coverCredit:"",coverImage:void 0,authors:[]}}),R=A.watch("description"),E=A.watch("content");async function T(e){try{if(x(!0),c(null),!e.title){A.setError("title",{type:"required",message:"Title is required"}),x(!1);return}if(!e.description){A.setError("description",{type:"required",message:"Description is required"}),x(!1);return}if(!e.content){A.setError("content",{type:"required",message:"Content is required"}),x(!1);return}if(!e.category){A.setError("category",{type:"required",message:"Category is required"}),x(!1);return}if(!e.authors.length){A.setError("authors",{type:"required",message:"At least one author is required"}),x(!1);return}let t=new FormData;for(let[a,s]of Object.entries(e))"authors"===a?s.forEach(e=>{t.append("authors[]",e)}):"category"===a?t.append("categories[]",s):"tags"===a?s&&Array.isArray(s)&&s.forEach(e=>{t.append("tags[]",e)}):"coverImage"!==a&&t.append(a,s);e.coverImage instanceof File&&t.append("coverImage",e.coverImage);let s=await fetch("/api/publications",{method:"POST",body:t});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to create publication")}let r=await s.json();A.reset(),a(!1),null==l||l(),n.push("/dashboard/publications/".concat(r.id))}catch(e){console.error("Form submission error:",e),c(e instanceof Error?e.message:"An error occurred"),S.oR.error("Failed to create publication",{description:e instanceof Error?e.message:"Please try again"})}finally{x(!1)}}(0,r.useEffect)(()=>{let e=async()=>{try{v(!0);let e=await fetch("/api/authors");if(!e.ok)throw Error("Failed to fetch authors");let t=await e.json();f(t)}catch(e){console.error("Error fetching authors:",e),S.oR.error("Failed to fetch authors",{description:"Please try again."})}finally{v(!1)}try{let e=await fetch("/api/categories");if(!e.ok)throw Error("Failed to fetch categories");let t=await e.json();g(t)}catch(e){console.error("Error fetching categories:",e),S.oR.error("Failed to fetch categories",{description:"Please try again."})}try{let e=await fetch("/api/tags");if(!e.ok)throw Error("Failed to fetch tags");let t=await e.json();y(t)}catch(e){console.error("Error fetching tags:",e),S.oR.error("Failed to fetch tags",{description:"Please try again."})}};t&&e()},[t]),(0,r.useEffect)(()=>{t||(A.reset(),c(null))},[t,A]);let D=async e=>{try{C(!0);let t=await fetch("/api/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})});if(!t.ok)throw Error("Failed to create tag");let a=await t.json();y(e=>[...e,a]);let s=new Set(A.getValues("tags")||[]);s.add(a.id),A.setValue("tags",Array.from(s),{shouldValidate:!0}),S.oR.success("Tag created successfully")}catch(e){console.error("Error creating tag:",e),S.oR.error("Failed to create tag",{description:"Please try again."})}finally{C(!1)}};return(0,s.jsx)(O.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(O.Cf,{className:"sm:max-w-[625px] max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(O.c7,{children:[(0,s.jsx)(O.L3,{children:"Create Publication"}),(0,s.jsx)(O.rr,{children:"Create a new publication. Click save when you're done."})]}),(0,s.jsx)(U.lV,{...A,children:(0,s.jsxs)("form",{onSubmit:A.handleSubmit(T),className:"space-y-8",children:[(0,s.jsx)(U.zB,{control:A.control,name:"title",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Title"}),(0,s.jsx)(U.MJ,{children:(0,s.jsx)(d.p,{placeholder:"Enter title",...t})}),(0,s.jsx)(U.Rr,{children:"The title of your publication. This will be displayed prominently."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"description",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Description"}),(0,s.jsx)(U.MJ,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(V.T,{placeholder:"Enter description",...t}),(0,s.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:[(null==R?void 0:R.length)||0,"/500"]})]})}),(0,s.jsx)(U.Rr,{children:"A brief summary of the publication. This will appear in listings and previews."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"content",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Content"}),(0,s.jsx)(U.MJ,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(V.T,{placeholder:"Enter content",className:"min-h-[200px]",...t}),(0,s.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:[(null==E?void 0:E.length)||0," characters"]})]})}),(0,s.jsx)(U.Rr,{children:"The main content of your publication. Minimum 50 characters required."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(U.zB,{control:A.control,name:"status",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Status"}),(0,s.jsxs)(u.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(U.MJ,{children:(0,s.jsx)(u.bq,{children:(0,s.jsx)(u.yv,{placeholder:"Select status"})})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"DRAFT",children:"Draft"}),(0,s.jsx)(u.eb,{value:"PUBLISHED",children:"Published"})]})]}),(0,s.jsx)(U.Rr,{children:"Draft publications are not visible to the public."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"category",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Category"}),(0,s.jsxs)(u.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(U.MJ,{children:(0,s.jsx)(u.bq,{children:(0,s.jsx)(u.yv,{placeholder:"Select a category"})})}),(0,s.jsx)(u.gC,{children:j.map(e=>(0,s.jsx)(u.eb,{value:e.id,children:e.name},e.id))})]}),(0,s.jsx)(U.Rr,{children:"Select a primary category for your publication."}),(0,s.jsx)(U.C5,{})]})}})]}),(0,s.jsx)(U.zB,{control:A.control,name:"authors",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Authors"}),(0,s.jsxs)(_.AM,{children:[(0,s.jsx)(_.Wv,{asChild:!0,children:(0,s.jsx)(U.MJ,{children:(0,s.jsxs)(o.$,{variant:"outline",role:"combobox",className:(0,q.cn)("w-full justify-between",!t.value.length&&"text-muted-foreground"),children:[t.value.length>0?"".concat(t.value.length," author").concat(t.value.length>1?"s":""," selected"):"Select authors",(0,s.jsx)(I.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(_.hl,{className:"w-[400px] p-0",children:(0,s.jsxs)(H.uB,{children:[(0,s.jsx)(H.G7,{placeholder:"Search authors..."}),(0,s.jsxs)(H.oI,{children:[(0,s.jsx)(H.xL,{children:"No authors found."}),(0,s.jsx)(H.L$,{children:p.map(e=>(0,s.jsxs)(H.h_,{onSelect:()=>{let a=new Set(t.value);a.has(e.id)?a.delete(e.id):a.add(e.id),t.onChange(Array.from(a))},children:[(0,s.jsx)(L.A,{className:(0,q.cn)("mr-2 h-4 w-4",t.value.includes(e.id)?"opacity-100":"opacity-0")}),e.firstName," ",e.lastName]},e.id))})]})]})})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:t.value.map(e=>{let t=p.find(t=>t.id===e);return t?(0,s.jsxs)(k.E,{variant:"secondary",className:"text-sm",children:[t.firstName," ",t.lastName]},t.id):null})}),(0,s.jsx)(U.Rr,{children:"Select one or more authors for this publication."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"coverImage",render:e=>{let{field:{value:t,onChange:a,...r}}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Cover Image"}),(0,s.jsx)(U.MJ,{children:(0,s.jsx)(d.p,{type:"file",accept:"image/*",onChange:e=>{var t;a(null==(t=e.target.files)?void 0:t[0])},...r})}),(0,s.jsx)(U.Rr,{children:"Upload an image (max 5MB). Recommended size: 1200x630 pixels."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"coverCredit",render:e=>{let{field:t}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Cover Image Credit"}),(0,s.jsx)(U.MJ,{children:(0,s.jsx)(d.p,{placeholder:"Enter cover image credit",...t})}),(0,s.jsx)(U.Rr,{children:"Credit the creator or source of the cover image if applicable."}),(0,s.jsx)(U.C5,{})]})}}),(0,s.jsx)(U.zB,{control:A.control,name:"tags",render:e=>{var t,a;let{field:r}=e;return(0,s.jsxs)(U.eI,{children:[(0,s.jsx)(U.lR,{children:"Tags"}),(0,s.jsxs)(_.AM,{children:[(0,s.jsx)(_.Wv,{asChild:!0,children:(0,s.jsx)(U.MJ,{children:(0,s.jsxs)(o.$,{variant:"outline",role:"combobox",className:(0,q.cn)("w-full justify-between",!(null==(t=r.value)?void 0:t.length)&&"text-muted-foreground"),children:[r.value&&r.value.length>0?"".concat(r.value.length," tag").concat(r.value.length>1?"s":""," selected"):"Select tags",(0,s.jsx)(I.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(_.hl,{className:"w-[400px] p-0",children:(0,s.jsxs)(H.uB,{children:[(0,s.jsx)(H.G7,{placeholder:"Search tags...",onValueChange:e=>{let t=document.getElementById("new-tag-text");t&&(t.textContent=e)}}),(0,s.jsxs)(H.oI,{children:[(0,s.jsx)(H.xL,{children:(0,s.jsxs)(o.$,{variant:"outline",size:"sm",className:"w-full justify-start mt-2",onClick:()=>{let e=document.querySelector("[cmdk-input]"),t=null==e?void 0:e.value;t&&""!==t.trim()&&D(t)},children:[(0,s.jsx)(B.A,{className:"mr-2 h-4 w-4"}),'Create "',(0,s.jsx)("span",{id:"new-tag-text"}),'"']})}),(0,s.jsx)(H.L$,{children:b.map(e=>{var t;return(0,s.jsxs)(H.h_,{onSelect:()=>{let t=new Set(r.value||[]);t.has(e.id)?t.delete(e.id):t.add(e.id),r.onChange(Array.from(t))},children:[(0,s.jsx)(L.A,{className:(0,q.cn)("mr-2 h-4 w-4",(null==(t=r.value)?void 0:t.includes(e.id))?"opacity-100":"opacity-0")}),e.name]},e.id)})})]})]})})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:null==(a=r.value)?void 0:a.map(e=>{let t=b.find(t=>t.id===e);return t?(0,s.jsx)(k.E,{variant:"secondary",className:"text-sm",children:t.name},t.id):null})}),(0,s.jsx)(U.Rr,{children:"Select existing tags or type to create new ones for better discoverability."}),(0,s.jsx)(U.C5,{})]})}}),i&&(0,s.jsx)("div",{className:"text-sm font-medium text-destructive bg-destructive/10 p-3 rounded-md mb-4",children:i}),(0,s.jsxs)(O.Es,{children:[(0,s.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(o.$,{type:"submit",disabled:h,children:h?"Creating...":"Create"})]})]})})]})})}function J(e){let{searchQuery:t,statusFilter:a,categoryFilter:l}=e,n=(0,m.useRouter)(),[c,d]=(0,r.useState)([]),[h,z]=(0,r.useState)(new Set),[P,F]=(0,r.useState)(!0),[I,L]=(0,r.useState)(null),[B,O]=(0,r.useState)(!1),[U,V]=(0,r.useState)(null),[H,_]=(0,r.useState)(!1),[q,$]=(0,r.useState)(!1),[J,Z]=(0,r.useState)("updatedAt"),[Y,W]=(0,r.useState)("desc"),[G,Q]=(0,r.useState)(!1),[X,K]=(0,r.useState)(!1),[ee,et]=(0,r.useState)("PUBLISHED"),ea={DRAFT:{label:"Draft",icon:x.A,variant:"secondary"},PUBLISHED:{label:"Published",icon:p.A,variant:"default"},ARCHIVED:{label:"Archived",icon:f.A,variant:"outline"}},es=async()=>{try{F(!0),L(null);let e=new URLSearchParams;t&&e.append("search",t),a&&"all"!==a&&e.append("status",a.toUpperCase()),l&&e.append("category",l),e.append("sort",J),e.append("order",Y);let s=await fetch("/api/publications?".concat(e.toString()));if(!s.ok)throw Error("Failed to fetch publications");let r=await s.json();d(r.publications||[])}catch(e){console.error("Error fetching publications:",e),L("Failed to fetch publications. Please try again.")}finally{F(!1)}};(0,r.useEffect)(()=>{es()},[t,a,l,J,Y]);let er=e=>{J===e?W("asc"===Y?"desc":"asc"):(Z(e),W("asc"))},el=e=>{let t=new Set(h);t.has(e)?t.delete(e):t.add(e),z(t)},en=async e=>{try{_(!0),L(null),await Promise.all(e.map(e=>fetch("/api/publications/".concat(e),{method:"DELETE"}))),d(t=>t.filter(t=>!e.includes(t.id))),z(new Set),Q(!1)}catch(e){console.error("Error deleting publications:",e),L("Failed to delete publications. Please try again.")}finally{_(!1)}},ei=async()=>{try{$(!0),L(null),await Promise.all(Array.from(h).map(e=>fetch("/api/publications/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:ee})}))),await es(),z(new Set),K(!1)}catch(e){console.error("Error updating publications:",e),L("Failed to update publications. Please try again.")}finally{$(!1)}},ec=async(e,t)=>{try{F(!0),L(null);let a=await fetch("/api/publications/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update publication status")}let s=await a.json();d(t=>t.map(t=>t.id===e?s:t)),S.oR.success("Publication status updated successfully")}catch(e){console.error("Error updating publication status:",e),L(e instanceof Error?e.message:"Failed to update publication status"),S.oR.error("Failed to update publication status")}finally{F(!1)}};if(I)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-[400px] gap-4",children:[(0,s.jsx)("p",{className:"text-destructive",children:I}),(0,s.jsxs)(o.$,{variant:"outline",onClick:es,children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Try Again"]})]});let eo="asc"===Y?g.A:b.A;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4 p-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:h.size>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>K(!0),children:"Update Status"}),(0,s.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>Q(!0),children:"Delete Selected"}),(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([[["Title","Status","Authors","Last Updated"],...c.filter(e=>h.has(e.id)).map(e=>[e.title,e.status,e.authors.map(e=>"".concat(e.profile.firstName," ").concat(e.profile.lastName)).join(", "),new Date(e.updatedAt).toLocaleString()])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="publications.csv",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t),document.body.removeChild(a)},children:[(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Export Selected"]}),(0,s.jsxs)(k.E,{variant:"secondary",children:[h.size," selected"]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:es,children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Refresh"]}),(0,s.jsxs)(R.rI,{children:[(0,s.jsx)(R.ty,{asChild:!0,children:(0,s.jsxs)(o.$,{variant:"outline",size:"sm",children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"View Options"]})}),(0,s.jsxs)(R.SQ,{align:"end",className:"w-[200px]",children:[(0,s.jsx)(R.lp,{children:"Sort By"}),(0,s.jsx)(R.mB,{}),(0,s.jsx)(R.hO,{checked:"title"===J,onCheckedChange:()=>er("title"),children:"Title"}),(0,s.jsx)(R.hO,{checked:"status"===J,onCheckedChange:()=>er("status"),children:"Status"}),(0,s.jsx)(R.hO,{checked:"updatedAt"===J,onCheckedChange:()=>er("updatedAt"),children:"Last Updated"}),(0,s.jsx)(R.mB,{}),(0,s.jsx)(R.hO,{checked:"asc"===Y,onCheckedChange:()=>W("asc"===Y?"desc":"asc"),children:"Ascending Order"})]})]})]})]}),(0,s.jsx)("div",{className:"relative w-full p-4",children:(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsxs)(A.XI,{children:[(0,s.jsx)(A.A0,{children:(0,s.jsxs)(A.Hj,{className:"hover:bg-transparent border-0",children:[(0,s.jsx)(A.nd,{className:"w-[40px] h-10",children:(0,s.jsx)(T.S,{checked:h.size===c.length&&c.length>0,onCheckedChange:()=>{h.size===c.length?z(new Set):z(new Set(c.map(e=>e.id)))},"aria-label":"Select all"})}),(0,s.jsxs)(A.nd,{className:"font-medium text-primary h-10 cursor-pointer",onClick:()=>er("title"),children:["Title ","title"===J&&(0,s.jsx)(eo,{className:"inline-block ml-1 h-4 w-4"})]}),(0,s.jsx)(A.nd,{className:"font-medium text-primary h-10",children:"Authors"}),(0,s.jsxs)(A.nd,{className:"font-medium text-primary h-10 cursor-pointer",onClick:()=>er("status"),children:["Status ","status"===J&&(0,s.jsx)(eo,{className:"inline-block ml-1 h-4 w-4"})]}),(0,s.jsxs)(A.nd,{className:"font-medium text-primary h-10 cursor-pointer",onClick:()=>er("updatedAt"),children:["Last Updated ","updatedAt"===J&&(0,s.jsx)(eo,{className:"inline-block ml-1 h-4 w-4"})]}),(0,s.jsx)(A.nd,{className:"w-[100px] h-10",children:"Actions"})]})}),(0,s.jsx)(A.BF,{children:P?(0,s.jsx)(A.Hj,{children:(0,s.jsx)(A.nA,{colSpan:6,className:"h-24 text-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading publications..."})]})})}):0===c.length?(0,s.jsx)(A.Hj,{children:(0,s.jsx)(A.nA,{colSpan:6,className:"h-24 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No publications found"}),t||"all"!==a?(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Try adjusting your filters"}):(0,s.jsx)(o.$,{variant:"link",className:"text-xs mt-2",onClick:()=>O(!0),children:"Create your first publication"})]})})}):c.map(e=>{let t=ea[e.status].icon;return(0,s.jsxs)(A.Hj,{className:"group hover:bg-accent/5 data-[state=selected]:bg-accent/10",children:[(0,s.jsx)(A.nA,{className:"py-3",children:(0,s.jsx)(T.S,{checked:h.has(e.id),onCheckedChange:()=>el(e.id),"aria-label":"Select ".concat(e.title)})}),(0,s.jsx)(A.nA,{className:"py-3 font-medium",children:e.title}),(0,s.jsx)(A.nA,{className:"py-3",children:(0,s.jsx)("div",{className:"flex -space-x-2",children:e.authors.map((e,t)=>(0,s.jsxs)(E.eu,{className:"h-8 w-8 border-2 border-background transition-transform group-hover:translate-x-0 group-hover:scale-105",style:{transform:"translateX(".concat(-4*t,"px)")},children:[(0,s.jsx)(E.BK,{src:e.profile.photoUrl||"",alt:"".concat(e.profile.firstName," ").concat(e.profile.lastName)}),(0,s.jsxs)(E.q5,{children:[e.profile.firstName[0],e.profile.lastName[0]]})]},t))})}),(0,s.jsx)(A.nA,{className:"py-3",children:(0,s.jsxs)(k.E,{variant:ea[e.status].variant,className:"font-normal",children:[(0,s.jsx)(t,{className:"mr-1 h-3 w-3"}),ea[e.status].label]})}),(0,s.jsx)(A.nA,{className:"py-3 text-muted-foreground",children:new Date(e.updatedAt).toLocaleDateString()}),(0,s.jsx)(A.nA,{className:"py-3",children:(0,s.jsxs)(R.rI,{children:[(0,s.jsx)(R.ty,{asChild:!0,children:(0,s.jsxs)(o.$,{variant:"ghost",className:"flex h-8 w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,s.jsxs)(R.SQ,{align:"end",className:"w-[160px]",children:[(0,s.jsxs)(R._2,{onClick:()=>n.push("/dashboard/publications/".concat(e.id)),children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"View"]}),(0,s.jsxs)(R._2,{onClick:()=>n.push("/dashboard/publications/".concat(e.id,"/edit")),children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,s.jsx)(R.mB,{}),(0,s.jsxs)(R.lv,{children:[(0,s.jsxs)(R.nV,{children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Set Status"]}),(0,s.jsxs)(R.M5,{children:[(0,s.jsxs)(R._2,{onClick:()=>ec(e.id,"DRAFT"),children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Draft"]}),(0,s.jsxs)(R._2,{onClick:()=>ec(e.id,"PUBLISHED"),children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Published"]}),(0,s.jsxs)(R._2,{onClick:()=>ec(e.id,"ARCHIVED"),children:[(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Archived"]})]})]}),(0,s.jsx)(R.mB,{}),(0,s.jsxs)(R._2,{className:"text-destructive",onClick:()=>V(e.id),children:[(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id)})})]})})}),(0,s.jsx)(M,{open:B,onOpenChange:O,onSuccess:es}),(0,s.jsx)(D.Lt,{open:!!U,onOpenChange:()=>V(null),children:(0,s.jsxs)(D.EO,{children:[(0,s.jsxs)(D.wd,{children:[(0,s.jsx)(D.r7,{children:"Are you sure?"}),(0,s.jsx)(D.$v,{children:"This action cannot be undone. This will permanently delete the publication and all its associated data."})]}),(0,s.jsxs)(D.ck,{children:[(0,s.jsx)(D.Zr,{children:"Cancel"}),(0,s.jsx)(D.Rx,{onClick:()=>U&&en([U]),disabled:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:H?"Deleting...":"Delete"})]})]})}),(0,s.jsx)(D.Lt,{open:G,onOpenChange:Q,children:(0,s.jsxs)(D.EO,{children:[(0,s.jsxs)(D.wd,{children:[(0,s.jsx)(D.r7,{children:"Delete Selected Publications"}),(0,s.jsxs)(D.$v,{children:["Are you sure you want to delete ",h.size," selected publications? This action cannot be undone."]})]}),(0,s.jsxs)(D.ck,{children:[(0,s.jsx)(D.Zr,{children:"Cancel"}),(0,s.jsx)(D.Rx,{onClick:()=>en(Array.from(h)),disabled:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:H?"Deleting...":"Delete Selected"})]})]})}),(0,s.jsx)(D.Lt,{open:X,onOpenChange:K,children:(0,s.jsxs)(D.EO,{children:[(0,s.jsxs)(D.wd,{children:[(0,s.jsx)(D.r7,{children:"Update Publication Status"}),(0,s.jsxs)(D.$v,{children:["Update the status of ",h.size," selected publications."]})]}),(0,s.jsx)("div",{className:"py-4",children:(0,s.jsxs)(u.l6,{value:ee,onValueChange:e=>et(e),children:[(0,s.jsx)(u.bq,{children:(0,s.jsx)(u.yv,{placeholder:"Select new status"})}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"DRAFT",children:"Draft"}),(0,s.jsx)(u.eb,{value:"PUBLISHED",children:"Published"}),(0,s.jsx)(u.eb,{value:"ARCHIVED",children:"Archived"})]})]})}),(0,s.jsxs)(D.ck,{children:[(0,s.jsx)(D.Zr,{children:"Cancel"}),(0,s.jsx)(D.Rx,{onClick:ei,disabled:q,children:q?"Updating...":"Update Status"})]})]})})]})}function Z(){let[e,t]=(0,r.useState)(!1),[a,m]=(0,r.useState)(""),[x,p]=(0,r.useState)("all"),[f,j]=(0,r.useState)(0),[g,b]=(0,r.useState)(0);return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/publications/count");if(e.ok){let t=await e.json();b(t.count)}}catch(e){console.error("Error fetching total publications:",e)}})()},[]),(0,s.jsxs)("div",{className:"flex flex-col gap-8 p-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Publications"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Create and manage your publications"})]}),(0,s.jsxs)(o.$,{onClick:()=>t(!0),children:[(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"New Publication"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)(h.Zp,{className:"md:col-span-2",children:[(0,s.jsxs)(h.aR,{children:[(0,s.jsx)(h.ZB,{children:"Search and Filter"}),(0,s.jsx)(h.BT,{children:"Find publications by title or filter by status."})]}),(0,s.jsx)(h.Wu,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(d.p,{placeholder:"Search publications...",className:"pl-8",value:a,onChange:e=>m(e.target.value)})]})}),(0,s.jsxs)(u.l6,{value:x,onValueChange:p,children:[(0,s.jsxs)(u.bq,{className:"w-full md:w-[200px]",children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"}),(0,s.jsx)(u.yv,{placeholder:"All Status"})]}),(0,s.jsxs)(u.gC,{children:[(0,s.jsx)(u.eb,{value:"all",children:"All Status"}),(0,s.jsx)(u.eb,{value:"DRAFT",children:"Draft"}),(0,s.jsx)(u.eb,{value:"PUBLISHED",children:"Published"}),(0,s.jsx)(u.eb,{value:"ARCHIVED",children:"Archived"})]})]})]})})]}),(0,s.jsxs)(h.Zp,{children:[(0,s.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(h.ZB,{className:"text-sm font-medium",children:"Total Publications"}),(0,s.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(h.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Publications in the system"})]})]})]}),(0,s.jsx)(h.Zp,{children:(0,s.jsx)(h.Wu,{className:"p-0",children:(0,s.jsx)(J,{searchQuery:a,statusFilter:x},f)})}),(0,s.jsx)(M,{open:e,onOpenChange:t,onSuccess:()=>{j(e=>e+1)}})]})}},14636:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>c,hl:()=>o});var s=a(95155),r=a(12115),l=a(20547),n=a(59434);let i=l.bL,c=l.l9;l.Mz;let o=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,...c}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsx)(l.UC,{ref:t,align:r,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})})});o.displayName=l.UC.displayName},18691:(e,t,a)=>{Promise.resolve().then(a.bind(a,3132))},44838:(e,t,a)=>{"use strict";a.d(t,{I:()=>h,M5:()=>p,SQ:()=>f,_2:()=>j,hO:()=>g,lp:()=>b,lv:()=>m,mB:()=>y,nV:()=>x,rI:()=>d,ty:()=>u});var s=a(95155),r=a(12115),l=a(48698),n=a(73158),i=a(10518),c=a(70154),o=a(59434);let d=l.bL,u=l.l9,h=l.YJ;l.ZL;let m=l.Pb;l.z6;let x=r.forwardRef((e,t)=>{let{className:a,inset:r,children:i,...c}=e;return(0,s.jsxs)(l.ZP,{ref:t,className:(0,o.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...c,children:[i,(0,s.jsx)(n.A,{className:"ml-auto"})]})});x.displayName=l.ZP.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.G5,{ref:t,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})});p.displayName=l.G5.displayName;let f=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsx)(l.UC,{ref:t,sideOffset:r,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});f.displayName=l.UC.displayName;let j=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(l.q7,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",a),...n})});j.displayName=l.q7.displayName;let g=r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...c}=e;return(0,s.jsxs)(l.H_,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...c,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),r]})});g.displayName=l.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.hN,{ref:t,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(c.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=l.hN.displayName;let b=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...n})});b.displayName=l.JU.displayName;let y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});y.displayName=l.wv.displayName},47262:(e,t,a)=>{"use strict";a.d(t,{S:()=>c});var s=a(95155),r=a(12115),l=a(76981),n=a(10518),i=a(59434);let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(l.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})})});c.displayName=l.bL.displayName},85127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>i,BF:()=>c,Hj:()=>o,XI:()=>n,nA:()=>u,nd:()=>d});var s=a(95155),r=a(12115),l=a(59434);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",a),...r})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...r})});i.displayName="TableHeader";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...r})});c.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});o.displayName="TableRow";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,l.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});d.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,l.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},90010:(e,t,a)=>{"use strict";a.d(t,{$v:()=>f,EO:()=>h,Lt:()=>c,Rx:()=>j,Zr:()=>g,ck:()=>x,r7:()=>p,tv:()=>o,wd:()=>m});var s=a(95155),r=a(12115),l=a(17649),n=a(59434),i=a(30285);let c=l.bL,o=l.l9,d=l.ZL,u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});u.displayName=l.hJ.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});h.displayName=l.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};m.displayName="AlertDialogHeader";let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="AlertDialogFooter";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...r})});p.displayName=l.hE.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});f.displayName=l.VY.displayName;let j=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.rc,{ref:t,className:(0,n.cn)((0,i.r)(),a),...r})});j.displayName=l.rc.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.ZD,{ref:t,className:(0,n.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});g.displayName=l.ZD.displayName},91394:(e,t,a)=>{"use strict";a.d(t,{BK:()=>c,eu:()=>i,q5:()=>o});var s=a(95155),r=a(12115),l=a(85977),n=a(59434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});i.displayName=l.bL.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...r})});c.displayName=l._V.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});o.displayName=l.H4.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[9352,652,9764,3411,5521,1859,6671,7649,593,2562,2721,8441,1684,7358],()=>t(18691)),_N_E=e.O()}]);
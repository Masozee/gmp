(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6240],{63530:(e,t,s)=>{Promise.resolve().then(s.bind(s,71650))},68856:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});var a=s(95155),n=s(59434);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-primary/10",t),...s})}},71650:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(95155),n=s(12115),r=s(35695),i=s(62177),l=s(90221),d=s(55594),o=s(30285),c=s(22346),h=s(88262),x=s(17759),p=s(59409),j=s(62523),u=s(88539),m=s(66695),v=s(12543),f=s(4913),g=s(68856);let w=d.z.object({title:d.z.string().min(1,{message:"Title is required"}),abstract:d.z.string().optional(),speakerId:d.z.string().min(1,{message:"Speaker is required"}),eventId:d.z.string().optional(),videoUrl:d.z.string().url({message:"Must be a valid URL"}).optional().or(d.z.literal("")),duration:d.z.coerce.number().int().positive().optional(),startTime:d.z.string().optional(),endTime:d.z.string().optional()});function N(e){let{params:t}=e,s=n.use(t).id,d=(0,r.useRouter)(),{toast:N}=(0,h.d)(),[b,y]=(0,n.useState)([]),[k,C]=(0,n.useState)([]),[E,I]=(0,n.useState)(null),[T,R]=(0,n.useState)(!0),[S,z]=(0,n.useState)(!1),[P,B]=(0,n.useState)(null),[U,M]=(0,n.useState)(null),[F,J]=(0,n.useState)(null),A=(0,i.mN)({resolver:(0,l.u)(w),defaultValues:{title:"",abstract:"",speakerId:"",eventId:"",videoUrl:"",duration:void 0,startTime:"",endTime:""}});(0,n.useEffect)(()=>{(async()=>{R(!0);try{let e=await fetch("/api/presentations/".concat(s));if(404===e.status)return void B("Presentation not found");if(!e.ok)throw Error("Failed to fetch presentation");let t=await e.json();I(t),J(t.slides);let a=await fetch("/api/speakers");if(!a.ok)throw Error("Failed to fetch speakers");let n=await a.json();y(n.speakers||[]);let r=await fetch("/api/events");if(!r.ok)throw Error("Failed to fetch events");let i=await r.json();C(i.events||[]),A.reset({title:t.title,abstract:t.abstract||"",speakerId:t.speakerId,eventId:t.eventId||"",videoUrl:t.videoUrl||"",duration:t.duration,startTime:t.startTime?V(t.startTime):"",endTime:t.endTime?V(t.endTime):""})}catch(e){console.error("Error fetching data:",e),B("Failed to load data. Please try again."),N({title:"Error",description:"Failed to load presentation data.",variant:"destructive"})}finally{R(!1)}})()},[s,A,N]);let V=e=>new Date(e).toISOString().slice(0,16),_=async e=>{z(!0);try{let t=new FormData;t.append("title",e.title),e.abstract&&t.append("abstract",e.abstract),t.append("speakerId",e.speakerId),e.eventId&&t.append("eventId",e.eventId),e.videoUrl&&t.append("videoUrl",e.videoUrl),e.duration&&t.append("duration",String(e.duration)),e.startTime&&t.append("startTime",e.startTime),e.endTime&&t.append("endTime",e.endTime),U&&t.append("slides",U);let a=await fetch("/api/presentations/".concat(s),{method:"PATCH",body:t});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update presentation")}N({title:"Success",description:"Presentation updated successfully"}),d.push("/dashboard/presentations/".concat(s))}catch(e){console.error("Error updating presentation:",e),N({title:"Error",description:e instanceof Error?e.message:"Failed to update presentation",variant:"destructive"})}finally{z(!1)}};return T?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(g.E,{className:"h-10 w-1/3"}),(0,a.jsx)(g.E,{className:"h-10 w-20"})]}),(0,a.jsx)(c.w,{}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(g.E,{className:"h-8 w-1/4"}),(0,a.jsx)(g.E,{className:"h-4 w-1/3"})]}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[...Array(6)].map((e,t)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.E,{className:"h-4 w-1/4"}),(0,a.jsx)(g.E,{className:"h-10 w-full"})]},t))}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.E,{className:"h-4 w-1/4"}),(0,a.jsx)(g.E,{className:"h-32 w-full"})]})]}),(0,a.jsx)(m.wL,{children:(0,a.jsx)(g.E,{className:"h-10 w-1/4 ml-auto"})})]})]}):P||!E?(0,a.jsx)("div",{className:"flex h-[400px] items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:P||"Presentation not found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"The requested presentation could not be found or loaded."}),(0,a.jsxs)(o.$,{variant:"outline",onClick:()=>d.push("/dashboard/presentations"),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Back to Presentations"]})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Presentation"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Update presentation details"})]}),(0,a.jsxs)(o.$,{variant:"outline",onClick:()=>d.back(),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Back"]})]}),(0,a.jsx)(c.w,{}),(0,a.jsxs)(m.Zp,{children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{children:"Presentation Details"}),(0,a.jsx)(m.BT,{children:"Edit the details of your presentation"})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsx)(x.lV,{...A,children:(0,a.jsxs)("form",{onSubmit:A.handleSubmit(_),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsx)(x.zB,{control:A.control,name:"title",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Title"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(j.p,{placeholder:"Presentation title",...t})}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"speakerId",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Speaker"}),(0,a.jsxs)(p.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(x.MJ,{children:(0,a.jsx)(p.bq,{children:(0,a.jsx)(p.yv,{placeholder:"Select a speaker"})})}),(0,a.jsx)(p.gC,{children:b.map(e=>(0,a.jsxs)(p.eb,{value:e.id,children:[e.firstName," ",e.lastName,e.organization&&" (".concat(e.organization,")")]},e.id))})]}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"eventId",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Event (Optional)"}),(0,a.jsxs)(p.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(x.MJ,{children:(0,a.jsx)(p.bq,{children:(0,a.jsx)(p.yv,{placeholder:"Select an event (optional)"})})}),(0,a.jsxs)(p.gC,{children:[(0,a.jsx)(p.eb,{value:"",children:"None"}),k.map(e=>(0,a.jsx)(p.eb,{value:e.id,children:e.title},e.id))]})]}),(0,a.jsx)(x.Rr,{children:"Associate this presentation with an event"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"duration",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Duration (minutes)"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(j.p,{type:"number",placeholder:"Duration in minutes",...t,value:t.value||"",onChange:e=>{let s=""===e.target.value?void 0:parseInt(e.target.value);t.onChange(s)}})}),(0,a.jsx)(x.Rr,{children:"How long is the presentation"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"startTime",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Start Time"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(j.p,{type:"datetime-local",...t})}),(0,a.jsx)(x.Rr,{children:"When does the presentation start"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"endTime",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"End Time"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(j.p,{type:"datetime-local",...t})}),(0,a.jsx)(x.Rr,{children:"When does the presentation end"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(x.zB,{control:A.control,name:"videoUrl",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Video URL"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(j.p,{placeholder:"https://www.youtube.com/watch?v=...",...t})}),(0,a.jsx)(x.Rr,{children:"Link to a recorded video of the presentation"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)("div",{children:(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Slides"}),(0,a.jsx)(x.MJ,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.p,{type:"file",accept:".pdf,.ppt,.pptx,.key",onChange:e=>{e.target.files&&e.target.files[0]&&M(e.target.files[0])}}),F&&!U&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Current file: ",F.split("/").pop(),(0,a.jsx)(o.$,{variant:"link",className:"h-auto p-0 ml-2",onClick:()=>window.open(F,"_blank"),children:"View"})]}),U&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["New file selected: ",U.name]})]})}),(0,a.jsx)(x.Rr,{children:"Upload new presentation slides (PDF, PowerPoint, Keynote)"})]})})]}),(0,a.jsx)(x.zB,{control:A.control,name:"abstract",render:e=>{let{field:t}=e;return(0,a.jsxs)(x.eI,{children:[(0,a.jsx)(x.lR,{children:"Abstract"}),(0,a.jsx)(x.MJ,{children:(0,a.jsx)(u.T,{placeholder:"Write a summary of the presentation...",className:"min-h-[120px]",...t})}),(0,a.jsx)(x.Rr,{children:"A brief description of what the presentation is about"}),(0,a.jsx)(x.C5,{})]})}}),(0,a.jsx)(m.wL,{className:"flex justify-end px-0 pb-0",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>d.push("/dashboard/presentations/".concat(s)),disabled:S,children:"Cancel"}),(0,a.jsxs)(o.$,{type:"submit",disabled:S,children:[S&&(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})})]})})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9352,652,9764,5521,1859,6671,7721,8441,1684,7358],()=>t(63530)),_N_E=e.O()}]);